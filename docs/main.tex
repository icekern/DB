% ============================================
% Project Documentation Template
% Based on: Uniba - Collab Thesis Template
% Developed and maintained by Giulio Mallardi
% https://collab.uniba.it | © 2025 Collab
% Adapted for project documentation
% ============================================
\PassOptionsToPackage{table, dvipsnames}{xcolor}
\documentclass[a4paper,oneside,11pt]{report}
\usepackage[left=2.2cm,right=2.2cm,top=2.2cm,bottom=2.2cm]{geometry}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usepackage{xspace}
\usepackage{graphicx}
\usepackage{tikz}
\usetikzlibrary{positioning, shapes.geometric}
\usepackage{pgfplots}
\pgfplotsset{compat=1.18}
\usepackage[font=small,skip=1pt]{caption}
\usepackage{subcaption}
\usepackage{hyperref}
\hypersetup{
    colorlinks = true,
    allcolors=black
}
%This equals 1.3 linespacing in Word (compacted)
\linespread{1.15}

% Reduce spacing around floats and between text/floats
\setlength{\textfloatsep}{8pt plus 2pt minus 2pt}
\setlength{\floatsep}{8pt plus 2pt minus 2pt}
\setlength{\intextsep}{8pt plus 2pt minus 2pt}
\setlength{\abovecaptionskip}{4pt}
\setlength{\belowcaptionskip}{2pt}

\usepackage{fancyhdr}
\usepackage{ifthen}

% --- GitHub icon in page header (top right, clickable) ---
\usepackage{fontawesome5}
\pagestyle{fancy}
\fancyhf{}
\fancyhead[R]{\href{https://github.com/icekern/DB}{\color{black!60}{\Large\faGithub}}}
\fancyfoot[C]{\thepage}
\renewcommand{\headrulewidth}{0pt}
\fancypagestyle{plain}{%
  \fancyhf{}%
  \fancyhead[R]{\href{https://github.com/icekern/DB}{\color{black!60}{\LARGE\faGithub}}}%
  \fancyfoot[C]{\thepage}%
  \renewcommand{\headrulewidth}{0pt}%
}

% --- Pacchetti aggiuntivi per documentazione di progetto ---
\usepackage{amsmath, amssymb, amsthm}
\usepackage{booktabs}
\usepackage{tabularx}
\usepackage{longtable}
\usepackage{ltablex}
\usepackage{multirow}
\usepackage{array}
\usepackage{enumitem}
\usepackage{xcolor}

% --- Code listings (alternativa a minted, non richiede Python/Pygments) ---
\usepackage{listings}
\lstdefinestyle{unibastyle}{
    basicstyle=\ttfamily\small,
    keywordstyle=\color{blue}\bfseries,
    commentstyle=\color{gray}\itshape,
    stringstyle=\color{red!70!black},
    numberstyle=\tiny\color{gray},
    breaklines=true,
    frame=single,
    rulecolor=\color{black!30},
    numbers=left,
    tabsize=4,
    showstringspaces=false,
    captionpos=b,
    backgroundcolor=\color{black!3}
}
\lstset{style=unibastyle}

% SQL language
\lstdefinelanguage{SQL}{
    morekeywords={SELECT, FROM, WHERE, INSERT, INTO, VALUES, UPDATE, SET, DELETE,
                  CREATE, TABLE, ALTER, DROP, INDEX, VIEW, JOIN, INNER, LEFT, RIGHT,
                  OUTER, ON, AND, OR, NOT, IN, BETWEEN, LIKE, IS, NULL, AS, ORDER,
                  BY, GROUP, HAVING, DISTINCT, UNION, ALL, EXISTS, CASE, WHEN, THEN,
                  ELSE, END, PRIMARY, KEY, FOREIGN, REFERENCES, CHECK, DEFAULT,
                  CONSTRAINT, UNIQUE, CASCADE, TRIGGER, PROCEDURE, FUNCTION, BEGIN,
                  COMMIT, ROLLBACK, TRANSACTION, GRANT, REVOKE, WITH, RECURSIVE,
                  INTEGER, VARCHAR, CHAR, TEXT, BOOLEAN, DATE, TIMESTAMP, FLOAT,
                  DECIMAL, NUMERIC, SERIAL, BIGINT, SMALLINT, REAL, COUNT, SUM,
                  AVG, MIN, MAX, LIMIT, OFFSET, ASC, DESC, IF, REPLACE, TEMPORARY,
                  SCHEMA, DATABASE, USE, SHOW, DESCRIBE, EXPLAIN},
    sensitive=false,
    morecomment=[l]{--},
    morecomment=[s]{/*}{*/},
    morestring=[b]',
    morestring=[b]"
}

% Python language (used in Chapter 5 for Flask code snippets)
\lstdefinelanguage{Python}{
    morekeywords={def, return, if, else, elif, for, while, import, from, as, class,
                  try, except, finally, with, raise, pass, None, True, False, not,
                  and, or, in, is, lambda, yield, global, nonlocal, assert, del,
                  break, continue, exec, print},
    sensitive=true,
    morecomment=[l]{\#},
    morecomment=[s]{"""}{"""},
    morestring=[b]',
    morestring=[b]"
}

% --- Custom Boxes (tcolorbox) ---
% Three visual styles only: GREY (code/reference), VIOLET (reasoning/assumption), BLUE (info)
\usepackage[most]{tcolorbox}

% ===== STYLE 1: GREY — Code and reference text =====

\newtcblisting{sqlbox}[1][]{
    enhanced,
    breakable,
    listing only,
    listing options={
        language=SQL,
        basicstyle=\ttfamily\small,
        keywordstyle=\color{blue!70!black}\bfseries,
        stringstyle=\color{red!60!black},
        commentstyle=\color{black!45}\itshape,
        breaklines=true,
        showstringspaces=false,
        tabsize=4
    },
    colback=black!3!white,
    colframe=black!35,
    fonttitle=\bfseries\ttfamily\small,
    title={SQL},
    attach boxed title to top left={yshift=-2mm, xshift=5mm},
    boxed title style={colback=black!45, colframe=black!45},
    sharp corners,
    boxrule=0.8pt,
    left=4mm, right=4mm, top=5mm,
    before skip=6pt, after skip=6pt,
    #1
}

% Specification box (green, for requirement quotes)
\newtcolorbox{tracebox}[1][]{
    enhanced,
    colback=green!4!white,
    colframe=green!50!black,
    fonttitle=\bfseries\small,
    title={Specifications},
    attach boxed title to top left={yshift=-2mm, xshift=5mm},
    boxed title style={colback=green!50!black, colframe=green!50!black},
    sharp corners,
    boxrule=0.8pt,
    left=4mm, right=4mm, top=5mm,
    before skip=6pt, after skip=6pt,
    borderline west={3pt}{-4pt}{green!50!black},
    #1
}

% Generic grey highlight (no title, italic)
\newtcolorbox{highlightbox}[1][]{
    enhanced,
    colback=black!3!white,
    colframe=black!35,
    boxrule=0pt,
    borderline west={4pt}{0pt}{black!40},
    sharp corners,
    left=6mm, right=4mm, top=2mm, bottom=2mm,
    before skip=6pt, after skip=6pt,
    fontupper=\itshape,
    #1
}

% ===== STYLE 2: VIOLET — Reasoning and assumptions =====

\newtcolorbox{reasoningbox}[1][]{
    enhanced,
    colback=violet!4!white,
    colframe=violet!55!black,
    fonttitle=\bfseries\small,
    title={Assumption / Design Reasoning},
    attach boxed title to top left={yshift=-2mm, xshift=5mm},
    boxed title style={colback=violet!55!black, colframe=violet!55!black},
    sharp corners,
    boxrule=0.8pt,
    left=6mm, right=4mm, top=5mm,
    before skip=6pt, after skip=6pt,
    borderline west={4pt}{0pt}{violet!55!black},
    #1
}

\newtcolorbox{assumptionbox}[1][]{
    enhanced,
    colback=violet!4!white,
    colframe=violet!55!black,
    fonttitle=\bfseries\small,
    title={Assumption / Design Reasoning},
    attach boxed title to top left={yshift=-2mm, xshift=5mm},
    boxed title style={colback=violet!55!black, colframe=violet!55!black},
    sharp corners,
    boxrule=0.8pt,
    left=6mm, right=4mm, top=5mm,
    before skip=6pt, after skip=6pt,
    borderline west={4pt}{0pt}{violet!55!black},
    #1
}

% ===== STYLE 3: BLUE — Informational notes =====

\newtcolorbox{infobox}[1][]{
    enhanced,
    colback=blue!4!white,
    colframe=blue!55!black,
    fonttitle=\bfseries\small,
    title={Info},
    attach boxed title to top left={yshift=-2mm, xshift=5mm},
    boxed title style={colback=blue!55!black, colframe=blue!55!black},
    sharp corners,
    boxrule=0.8pt,
    left=4mm, right=4mm, top=5mm,
    before skip=6pt, after skip=6pt,
    #1
}

% Legacy aliases — all map to one of the three styles above
\newtcolorbox{notebox}[1][]{
    enhanced,
    colback=blue!4!white,
    colframe=blue!55!black,
    fonttitle=\bfseries\small,
    title={Note},
    attach boxed title to top left={yshift=-2mm, xshift=5mm},
    boxed title style={colback=blue!55!black, colframe=blue!55!black},
    sharp corners,
    boxrule=0.8pt,
    left=4mm, right=4mm, top=5mm,
    before skip=6pt, after skip=6pt,
    #1
}

% ============================================
%  METADATA – EDIT THESE FIELDS
% ============================================
\def\dept{DEPARTMENT OF COMPUTER SCIENCE}
\def\course{MASTER'S DEGREE IN COMPUTER SCIENCE}

\def\projecttitle{ConferenceHub Inc.}                        % <-- Project title
\def\projectsubtitle{Project Documentation}         % <-- Subtitle
\def\authorname{Andrea Porcelli}                            % <-- Your name
\def\subject{DATABASE}                             % <-- Subject
\def\docente{Prof. Antonio Pellicani}                   % <-- Professor name
\def\annoacc{2025 - 2026}                          % <-- Academic year

% Title page labels
\def\beforeauthor{STUDENT:}
\def\beforetitle{COURSE DOCUMENTATION \\}
\def\beforeprof{PROFESSOR:}
\def\beforeannoacc{ACADEMIC YEAR}

% ============================================
%  CLEARDOUBLEPAGE FIX
% ============================================
\makeatletter
\def\cleardoublepage{\clearpage\if@twoside \ifodd\c@page\else
    \hbox{}
    \vspace*{\fill}
    \vspace{\fill}
    \thispagestyle{empty}
    \newpage
    \if@twocolumn\hbox{}\newpage\fi\fi\fi}
\makeatother


% ============================================
%  DOCUMENT
% ============================================
\begin{document}

% --- Title Page (stile Collab UNIBA) ---
\begin{titlepage}
	\begin{tikzpicture}[remember picture,overlay]
		\centering
		\node[yshift=-6 cm] (logo) at (current page.north) {\includegraphics[width=0.75\linewidth]{images/logos/uniba.pdf}};
			\node[text width=50em,yshift=0.25cm, align = center, below = of logo](dipartimento){\normalsize \dept};
			\node[text width=40em, align = center, yshift=.55cm,below = of dipartimento](coursename){\normalsize \course};
		\node[text width=35em,align = center,  yshift=1.2cm,below = of coursename](line){\par\noindent\rule{\textwidth}{0.4pt}};
		\node[text width=40em, align = center, yshift=.55cm,below = of line](lia){\normalsize \beforetitle \xspace \subject };
		
  \node[text width=40em, align = center, yshift=-0.5cm,below = of lia](title){\bfseries \parbox{12cm}{\fontsize{21pt}{20pt}\selectfont \centering \projecttitle\par}};
  
  \node[text width=40em, align = center, yshift=0.3cm,below = of title](subtitle){\large \textit{\projectsubtitle}};

	\node[text width=35em, align = left, yshift=-0.5cm,below = of subtitle](proftit){\normalsize \textbf{\beforeprof} };
 	\node[text width=35em, align = left, yshift=1cm,below = of proftit](prof){\large \docente};
      
		\node[text width=35em, align = right, yshift=-0.5cm,below = of subtitle](candidatetit){\normalsize \textbf{\beforeauthor}};
		 \node[text width=35em, align = right, yshift=1cm,below = of candidatetit](candidate){\large \authorname};

  \node[text width=35em,align = center,  yshift= -3cm,below = of candidate](line2){\par\noindent\rule{\textwidth}{0.4pt}};
	
  \node[text width=50em, align = center, yshift=0.5cm,below = of line2](year){\large \beforeannoacc\xspace \annoacc};
	\end{tikzpicture}
\end{titlepage}


\cleardoublepage

% --- Table of Contents ---
\pagenumbering{roman}
\tableofcontents
\cleardoublepage

% ============================================
%  CONTENT
% ============================================
\pagenumbering{arabic}
\setcounter{page}{1}

% --- Introduction (unnumbered) ---
\addcontentsline{toc}{chapter}{Introduction}
\include{chapters/introduction}

% --- Chapters ---
\include{chapters/01_requirements_analysis}
\include{chapters/02_conceptual_schema}
\include{chapters/03_logical_schema}
\include{chapters/04_physical_schema}
\include{chapters/05_web_app}
\include{chapters/06_bonus}

% --- Conclusions ---
% \include{chapters/conclusions}

% --- Bibliography ---
% \bibliographystyle{plain}
% \bibliography{references}

\end{document}
